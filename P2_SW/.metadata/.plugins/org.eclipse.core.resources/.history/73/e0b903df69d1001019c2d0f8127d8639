#ifndef INTERRUPTS_H
#define INTERRUPTS_H

#include "xparameters.h"
#include "xscugic.h"
#include "xtmrctr.h"
#include "xgpio.h"
#include "xil_exception.h"

// --- IDs de Hardware ---
// Ajusta estos IDs si tus nombres en xparameters son distintos (ej: _0_DEVICE_ID)
#define INTC_DEVICE_ID       XPAR_SCUGIC_SINGLE_DEVICE_ID

#define TIMER0_DEVICE_ID     XPAR_AXI_TIMER_0_DEVICE_ID
#define TIMER0_IRPT_ID       XPAR_FABRIC_AXI_TIMER_0_INTERRUPT_INTR

#define TIMER1_DEVICE_ID     XPAR_AXI_TIMER_1_DEVICE_ID
#define TIMER1_IRPT_ID       XPAR_FABRIC_AXI_TIMER_1_INTERRUPT_INTR

#define LIGHT_GPIO_DEVICE_ID XPAR_AXI_GPIO_0_DEVICE_ID
#define LIGHT_GPIO_IRQ_ID    XPAR_FABRIC_AXI_GPIO_0_IP2INTC_IRPT_INTR
#define LIGHT_GPIO_CHANNEL   1

// Frecuencia del reloj (usualmente 100MHz = 100000000)
#define TIMER_CLOCK_HZ       XPAR_AXI_TIMER_0_CLOCK_FREQ_HZ

// Periodos deseados
#define TIMER0_PERIOD_SEC    0.001f // 1 ms (Música)
#define TIMER1_PERIOD_SEC    0.050f // 50 ms (Juego)

// --- Variables Externas ---
extern volatile int ao2_game_tick;
extern volatile int ao2_light_flag;
extern volatile u32 debug_isr_count;
extern XGpio ALightGpio;

// --- Prototipos (Estilo "Penalty Game") ---
int Initialize_Interrupt_Controller(XScuGic *IntcInstancePtr);
int Setup_Timer0_System(XScuGic *IntcInstancePtr, XTmrCtr *TmrInstancePtr);
int Setup_Timer1_System(XScuGic *IntcInstancePtr, XTmrCtr *TmrInstancePtr);
int Setup_GPIO_Light_System(XScuGic *IntcInstancePtr, XGpio *GpioInstancePtr);

void Start_Timers(XTmrCtr *Tmr0, XTmrCtr *Tmr1);

#endif
